<!DOCTYPE html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MÃ¼nchen Stadtrat Analytics</title>
    <link rel="icon" type="image/x-icon" href="../static/favicon2.png">
    <link rel="stylesheet" href="../static/style.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  </head>

  <body>

    <!-- Hero Section -->
    <header class="hero hero--wave">
      <div class="hero-overlay">
        <!-- <div class="design-switcher" aria-label="Design auswÃ¤hlen">
          <button class="design-btn" data-design="wave">Wave</button>
          <button class="design-btn" data-design="default">Default</button>
          <button class="design-btn" data-design="glass">Glass</button>
          <button class="design-btn" data-design="mesh">Mesh</button>
          <button class="design-btn" data-design="blobs">Blobs</button>
          <button class="design-btn" data-design="parallax">Parallax</button>
          <button class="design-btn" data-design="gradienttext">Gradient Text</button>
          <button class="design-btn" data-design="noise">Noise</button>
          <button class="design-btn" data-design="neumorphic">Neumorphic</button>
          <button class="design-btn" data-design="glassborder">Glass Border</button>
          <button class="design-btn" data-design="fade">Fade</button>
          <button class="design-btn" data-design="overlap">Overlap</button>
        </div> -->
        <div class="language-switcher">
          <button class="lang-btn" data-lang="de">ðŸ‡©ðŸ‡ª DE</button>
          <button class="lang-btn" data-lang="en">ðŸ‡¬ðŸ‡§ EN</button>
        </div>
        <div class="hero-content">
          <h1 class="hero-title" data-i18n="hero.title">What does Munich work on?</h1>
          <p class="hero-subtitle" data-i18n="hero.subtitle">Visualisierung und Analyse von StadtratsantrÃ¤gen</p>
        </div>
      </div>
      <!-- Optional shape divider for wave variant -->
      <div class="hero-divider" aria-hidden="true">
        <svg viewBox="0 0 1440 120" preserveAspectRatio="none">
          <path d="M0,48 C240,120 480,0 720,72 C960,144 1200,24 1440,88 L1440,120 L0,120 Z" fill="currentColor"></path>
        </svg>
      </div>
      <!-- Filler bar to close gap between divider and wave-window -->
      <div class="hero-divider-filler" aria-hidden="true"></div>
    </header>

    <!-- Main Container -->
    <main class="container">
      
      <!-- Search Section -->
      <section class="search-section">
        <div class="section-header">
          <h2 class="section-title" data-i18n="search.title">Themen durchsuchen</h2>
          <p class="section-description" data-i18n="search.description">Erkunden Sie die hÃ¤ufigsten Themen in MÃ¼nchner StadtratsantrÃ¤gen oder suchen Sie nach einem spezifischen Stichwort</p>
        </div>

        <!-- Quick Filter Tags -->
        <div class="quick-filters">
          <label class="filter-label" data-i18n="search.popular">Beliebte Themen:</label>
          <!-- <p style="font-size: 12px; color: #bbb;" data-i18n="search.popular.note"> (Es werden hier die am meisten vorkommenden Keywords mit Hilfe von spacy gefiltert, gecached und angezeigt, exclusive der in keyword_extractor.py ausgeschlossenen stop words) </p> -->

          <div class="example-searches" id="example-searches" data-count="16">
            <span class="loading-indicator" data-i18n="loading.indicator">Wird geladen...</span>
          </div>
        </div>

        <!-- Search Input -->
        <div class="search-hint" data-i18n="search.hint">Frag die AntrÃ¤ge, nicht die Orakel.</div>
        <div class="search-bar">
          <div class="search-input-wrapper">
            <svg class="search-icon" width="20" height="20" viewBox="0 0 20 20" fill="none">
              <path d="M9 17C13.4183 17 17 13.4183 17 9C17 4.58172 13.4183 1 9 1C4.58172 1 1 4.58172 1 9C1 13.4183 4.58172 17 9 17Z" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              <path d="M19 19L14.65 14.65" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
            <input
              type="text"
              id="searchInput"
              data-i18n-placeholder="search.placeholder"
              placeholder="Suchbegriff eingeben..."
              autocomplete="off"
            />
          </div>
          <button id="searchBtn" class="search-btn">
            <span data-i18n="search.button">Suchen</span>
          </button>
        </div>

         <!-- Expanded Search Terms Display -->
        <div id="expanded-terms-display" class="expanded-terms-display">
          <!-- Will be populated by JavaScript -->
        </div>

        <!-- Typ Filter -->
        <div class="typ-filter-section">
          <div class="typ-filter-header" id="typFilterToggle">
            <label class="filter-label" data-i18n="filter.type.label">Antragstyp filtern:</label>
            <button class="toggle-btn" data-i18n-aria="filter.toggle.aria" aria-label="Filter ein-/ausblenden">
              <svg class="toggle-icon" width="20" height="20" viewBox="0 0 20 20" fill="none">
                <path d="M5 7.5L10 12.5L15 7.5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </button>
          </div>
          <div id="typ-filter-content" class="typ-filter-content">
            <div id="typ-filter-checkboxes" class="typ-checkboxes">
              <!-- Will be populated by JavaScript -->
              <span class="loading-indicator" data-i18n="loading.indicator">Wird geladen...</span>
            </div>
          </div>
        </div>

        <!-- Date Range Filter -->
        <div class="date-filter-section">
          <div class="date-filter-header" id="dateFilterToggle">
            <label class="filter-label" data-i18n="filter.date.label">Zeitraum filtern:</label>
            <button class="toggle-btn">
              <svg class="toggle-icon" width="20" height="20" viewBox="0 0 20 20" fill="none">
                <path d="M5 7.5L10 12.5L15 7.5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </button>
          </div>
          
          <div id="date-filter-content" class="date-filter-content">
            <!-- Date Range Info -->
            <div id="date-range-display" class="date-range-info">
              <!-- Will be populated by JavaScript -->
            </div>
            
            <!-- Date Range Slider -->
            <div class="date-slider-container">
              <div class="slider-labels">
                <span id="sliderDateFrom" class="slider-label-start">-</span>
                <span id="sliderDateTo" class="slider-label-end">-</span>
              </div>
              
              <div class="slider-wrapper">
                <input 
                  type="range" 
                  id="dateSliderFrom" 
                  class="date-slider date-slider-from"
                  min="0" 
                  max="100" 
                  value="0"
                  data-i18n-aria="filter.date.slider.from"
                  aria-label="Startdatum"
                />
                <input 
                  type="range" 
                  id="dateSliderTo" 
                  class="date-slider date-slider-to"
                  min="0" 
                  max="100" 
                  value="100"
                  data-i18n-aria="filter.date.slider.to"
                  aria-label="Enddatum"
                />
                <div class="slider-track"></div>
                <div class="slider-track-active"></div>
                <div id="sliderHintFrom" class="slider-hint" aria-hidden="true"></div>
                <div id="sliderHintTo" class="slider-hint" aria-hidden="true"></div>
              </div>
              
              <button id="clearDateFilter" class="clear-btn" data-i18n="filter.date.clear">
                ZurÃ¼cksetzen
              </button>
            </div>
          </div>
        </div>

      </section>

      <!-- Visualizations -->
      <section class="visualizations" id="visualization">
        
        <!-- KPI Cards -->
        <div id="viz-kpi" class="kpi-section"></div>

        <!-- Charts Grid -->
        <div class="charts-grid">
          <div id="viz-trend" class="chart-card"></div>
          <div id="viz-trend-share" class="chart-card"></div>
          <div id="viz-fraktionen" class="chart-card"></div>
          <div id="viz-fraktionen-share" class="chart-card"></div>
          <div id="viz-topdocs" class="chart-card"></div>
          <div id="viz-metrics-chart" class="chart-card"></div>
          <!-- District-Party Map -->
          <div class="chart-card" style="min-height: 600px;">
            <div class="map-hint">
              <p data-i18n="map.hint">Die Karte zeigt, welche Fraktionen relativ zu ihrer GesamtaktivitÃ¤t in welchen Stadtteilen besonders aktiv sind (normalisierte Anteile). Die KreisgrÃ¶ÃŸe steht fÃ¼r die Zahl der ErwÃ¤hnungen, die Farben zeigen die Fraktionsanteile. Hinweis: Diese Karte ist statisch und wird nicht von den Filtern oben beeinflusst.</p>
            </div>
            <iframe 
              src="/static/munich_districts_fairshare_map.html" 
              style="width: 100%; height: 600px; border: none; border-radius: 8px;"
              title="Munich Districts - Party Distribution Map">
            </iframe>
          </div>
        </div>
        
      </section>

        <!-- Peek window showing the wave cut again over the background image -->
        <div class="wave-window" aria-hidden="true"></div>


        <!-- Applications List -->
        <div id="viz-applications" class="applications-section"></div>



    </main>

    <!-- Footer -->
    <footer class="footer">
      <div class="footer-content">
        <p data-i18n="footer.copyright">&copy; 2026 Elena Zimmermann, Anna Labchir, Matthias Staritz, Tobias Pfeifle</p>
        <div class="footer-links">
          <a href="{{ url_for('legal') }}#impressum" data-i18n="footer.imprint">Impressum</a>
          <a href="{{ url_for('legal') }}#datenschutz" data-i18n="footer.privacy">Datenschutzerkl&auml;rung</a>
          <a href="{{ url_for('legal') }}#haftung" data-i18n="footer.disclaimer">Haftungsausschluss</a>
          <a href="{{ url_for('methodik') }}" data-i18n="footer.methodology">Methodik</a>
        </div>
      </div>
    </footer>

    <!-- Load D3.js library -->
    <script src="https://d3js.org/d3.v7.min.js"></script>

    <!-- Load language switcher -->
    <script type="module" src="../static/language-switcher.js"></script>

    <!-- Load keyword loader script -->
    <script type="module" src="../static/keyword-loader.js"></script>

    <!-- Load main application with ES modules -->
    <script type="module" src="../static/js-viz/main.js"></script>
    
    <!-- Design switcher (module) -->
    <script type="module" src="../static/design-switcher.js"></script>
  </body>
</html>
